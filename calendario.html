<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calendario ðŸ’–</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(to bottom, #a1c4fd, #c2e9fb);
        text-align: center;
        margin: 0;
        padding: 0;
    }

    h1 {
        color: #002366;
        margin: 20px 0;
        text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
    }

    .botones-mes {
        margin: 20px;
        display: flex;
        justify-content: center;
        gap: 10px;
        flex-wrap: wrap;
    }

    .botones-mes button {
        padding: 10px 20px;
        border: none;
        background-color: #28a745;
        color: white;
        border-radius: 8px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s;
    }

    .botones-mes button:hover {
        background-color: #1e7e34;
    }

    .calendario {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 10px;
        width: 90%;
        max-width: 900px;
        margin: auto;
    }

    .dia-container {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .dia {
        background-color: rgba(255,255,255,0.95);
        border: 2px solid #fff;
        border-radius: 12px;
        position: relative;
        min-height: 120px;
        width: 100%;
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        transition: transform 0.2s, box-shadow 0.2s;
    }

    .dia:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0,0,0,0.3);
    }

    .dia strong {
        position: absolute;
        top: 5px;
        left: 5px;
        z-index: 2;
        background: rgba(0,0,0,0.5);
        color: white;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 14px;
    }

    .dia img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
    }

    .subir-foto {
        margin-top: 5px;
        width: 90%;
    }

    .subir-foto input[type="file"] {
        width: 100%;
        cursor: pointer;
        border-radius: 8px;
        border: 1px solid #ccc;
        padding: 4px;
        background-color: white;
        transition: background-color 0.2s;
    }

    .subir-foto input[type="file"]:hover {
        background-color: #f0f0f0;
    }

    .volver {
        display: inline-block;
        margin: 20px;
        padding: 10px 20px;
        background-color: #002366;
        color: white;
        border-radius: 8px;
        font-size: 16px;
        text-decoration: none;
        transition: background-color 0.3s;
    }

    .volver:hover {
        background-color: #0047ab;
    }

</style>
</head>
<body>
    <h1>ðŸ“… Calendario de Fotos ðŸ’–</h1>

    <div class="botones-mes">
        <button onclick="cambiarMes(-1)">â¬… Mes anterior</button>
        <span id="nombre-mes" style="font-weight:bold; font-size:18px; margin:0 10px;"></span>
        <button onclick="cambiarMes(1)">Mes siguiente âž¡</button>
    </div>

    <div class="calendario" id="calendario"></div>

    <a href="si.html" class="volver">â¬… Volver</a>

    <script>
        const meses = ["Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
        let mesActual = 0;

        function generarCalendario() {
            const calendarioDiv = document.getElementById('calendario');
            calendarioDiv.innerHTML = '';
            const diasMes = 30;

            for(let dia=1; dia<=diasMes; dia++){
                const diaContainer = document.createElement('div');
                diaContainer.className = 'dia-container';

                const diaDiv = document.createElement('div');
                diaDiv.className = 'dia';
                diaDiv.id = `mes${mesActual}_dia${dia}`;
                diaDiv.innerHTML = `<strong>${dia}</strong>`;

                // Foto guardada
                const fotoURL = localStorage.getItem(`mes${mesActual}_dia${dia}`);
                if(fotoURL){
                    const img = document.createElement('img');
                    img.src = fotoURL;
                    diaDiv.appendChild(img);
                }

                diaContainer.appendChild(diaDiv);

                // BotÃ³n de subir foto debajo del cuadro
                const subirDiv = document.createElement('div');
                subirDiv.className = 'subir-foto';
                subirDiv.innerHTML = `<input type="file" accept="image/*" onchange="subirFoto(event, ${dia})">`;
                diaContainer.appendChild(subirDiv);

                calendarioDiv.appendChild(diaContainer);
            }

            document.getElementById('nombre-mes').textContent = meses[mesActual];
        }

        function cambiarMes(dir){
            mesActual = (mesActual + dir + meses.length) % meses.length;
            generarCalendario();
        }

        async function subirFoto(event, dia){
            const file = event.target.files[0];
            if(!file) return;

            const formData = new FormData();
            formData.append('file', file);
            formData.append('upload_preset', 'subidas_diarias');

            const res = await fetch('https://api.cloudinary.com/v1_1/dfjoctj0t/image/upload', {
                method: 'POST',
                body: formData
            });

            const data = await res.json();
            const url = data.secure_url;

            // Guardar URL en localStorage
            localStorage.setItem(`mes${mesActual}_dia${dia}`, url);

            // Actualizar la imagen del dÃ­a
            const diaDiv = document.getElementById(`mes${mesActual}_dia${dia}`);
            const imgExistente = diaDiv.querySelector('img');
            if(imgExistente) imgExistente.remove();

            const img = document.createElement('img');
            img.src = url;
            diaDiv.appendChild(img);
        }

        generarCalendario();
    </script>
</body>
</html>
