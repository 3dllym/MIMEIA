<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Calendario</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>ðŸ“… Calendario</h1>
    <a href="index.html" class="boton">â¬… Volver</a>

    <div class="meses">
        <button onclick="mostrarMes('agosto')">Agosto</button>
        <button onclick="mostrarMes('septiembre')">Septiembre</button>
        <button onclick="mostrarMes('octubre')">Octubre</button>
        <button onclick="mostrarMes('noviembre')">Noviembre</button>
        <button onclick="mostrarMes('diciembre')">Diciembre</button>
    </div>

    <div id="calendario"></div>

    <script>
        const diasPorMes = {
            agosto: 31,
            septiembre: 30,
            octubre: 31,
            noviembre: 30,
            diciembre: 31
        };

        let fotos = [];

        // Cargar fotos existentes
        async function cargarFotos() {
            const res = await fetch('/fotos');
            fotos = await res.json();
        }

        function mostrarMes(mes) {
            const cont = document.getElementById('calendario');
            cont.innerHTML = `<h2>${mes.toUpperCase()}</h2>`;
            for (let i = 1; i <= diasPorMes[mes]; i++) {
                cont.innerHTML += `
                    <div class="dia">
                        <strong>DÃ­a ${i}</strong><br>
                        <form action="/subir" method="post" enctype="multipart/form-data">
                            <input type="file" name="foto" required>
                            <input type="submit" value="Subir foto">
                        </form>
                        <div class="fotos-dia" id="${mes}-${i}"></div>
                    </div>
                `;
            }
            mostrarFotos();
        }

        function mostrarFotos() {
            fotos.forEach(f => {
                // Intentamos obtener mes y dÃ­a del nombre de archivo si tiene formato mes-dia
                const div = document.getElementById(f.mesDia);
                if (div) {
                    const img = document.createElement('img');
                    img.src = '/uploads/' + f;
                    img.style.width = '100%';
                    img.style.marginTop = '5px';
                    div.appendChild(img);
                }
            });
        }

        // Mostrar agosto por defecto
        cargarFotos().then(() => mostrarMes('agosto'));
    </script>
</body>
</html>
